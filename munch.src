°°°±°	;		Program	:	MUNCH°°°²°	;		Date	:		July 22, 1982°°°³°	;		System	:		TRS-80 Model III°°°´°	;		Authors	:	Christopher D. Haight°°°µ°	;			 	John C. Orlowski°°°¶°	;°°±²°	;°°±³°		ORG	7000H		; After DEBUG!!°°±´°	VIDCLS	EQU	01C9H		; Video Clear Screen°°±µ°	VDLINE	EQU	021BH		; Display Line°°±¶°	MAZE	DEFS	1024°°±·°	MENPOS	DEFS	10°°±¸°	MEN	DEFS	10°°±¹°	SCORE	DEFS	6°°²°°	FRUIT	DEFS	6°°²±°	TURNOV	DEFS	2°°²²°	MENHAV	DEFS	2°°²³°	DOTS	DEFS	2°°²´°	DOTEAT	DEFS	2°°²µ°	ENGEAT	DEFS	1°°²¶°	MENVAL	DEFS	2°°²·°	RNDNUM	DEFS	2°°²¸°	FLAGS	DEFS	2°°²¹°	SAVRET	DEFW	0°°³°°	SCORED	DEFM	'Score: '°°³±°		DEFB	03H°°³²°	TURND	DEFM	'Turnovers: '°°³³°		DEFB	03H°°³´°	MENLFT	DEFM	'Men: '°°³µ°		DEFB	03H°°³¶°	ZEROES	DEFM	'0'°°³·°		DEFB	03H°°³¸°	DISPLY	DEFS	6°°³¹°		DEFB	03H°°´°°	PDIREC	DEFB	00H°°´±°	SWACKA	DEFB	20°°´²°		DEFB	5°°´³°		DEFB	30°°´´°		DEFB	5°°´µ°		DEFW	0000°°´¶°	TRILL	DEFW	51210°°´·°		DEFW	48650°°´¸°		DEFW	46090°°´¹°		DEFW	43530°°µ°°		DEFW	40970°°µ±°		DEFW	38410°°µ²°		DEFW	35850°°µ³°		DEFW	33290°°µ´°		DEFW	30730°°µµ°		DEFW	28170°°µ¶°		DEFW	25610°°µ·°		DEFW	23050°°µ¸°		DEFW	20490°°µ¹°		DEFW	19730°°¶°°		DEFW	15370°°¶±°		DEFW	12810°°¶²°		DEFW	10250°°¶³°		DEFW	07690°°¶´°		DEFW	05130°°¶µ°		DEFW	02570°°¶¶°		DEFW	00000°°¶·°	ORMNPS	DEFB	60°°¶¸°		DEFB	33°°¶¹°		DEFB	56°°·°°		DEFB	21°°·±°		DEFB	64°°·²°		DEFB	21°°·³°		DEFB	56°°·´°		DEFB	27°°·µ°		DEFB	64°°·¶°		DEFB	27°°··°	MONSTR	DEFB	000H°°·¸°		DEFB	0FFH°°·¹°		DEFB	0FFH°°¸°°		DEFB	0FFH°°¸±°		DEFB	000H°°¸²°		DEFB	000H°°¸³°		DEFB	0FFH°°¸´°		DEFB	0FFH°°¸µ°		DEFB	000H°°¸¶°		DEFB	0FFH°°¸·°		DEFB	0FFH°°¸¸°		DEFB	000H°°¸¹°		DEFB	0FFH°°¹°°		DEFB	000H°°¹±°		DEFB	0FFH°°¹²°		DEFB	000H°°¹³°		DEFB	0FFH°°¹´°		DEFB	000H°°¹µ°	SPACMN	DEFW	0FF00H°°¹¶°		DEFW	0FFFFH°°¹·°		DEFW	00000H°°¹¸°		DEFW	0FFFFH°°¹¹°		DEFW	0FF00H°±°°°		DEFW	000FFH°±°±°		DEFW	0FF00H°±°²°		DEFW	0FFFFH°±°³°		DEFW	00000H°±°´°	RPACMN	DEFW	0FF00H°±°µ°		DEFW	0FFFFH°±°¶°		DEFW	000FFH°±°·°		DEFW	0FFFFH°±°¸°		DEFW	00000H°±°¹°		DEFW	00000H°±±°°		DEFW	0FF00H°±±±°		DEFW	0FFFFH°±±²°		DEFW	000FFH°±±³°	LPACMN	DEFW	0FFFFH°±±´°		DEFW	0FFFFH°±±µ°		DEFW	00000H°±±¶°		DEFW	00000H°±±·°		DEFW	0FF00H°±±¸°		DEFW	000FFH°±±¹°		DEFW	0FFFFH°±²°°		DEFW	0FFFFH°±²±°		DEFW	00000H°±²²°	UPACMN	DEFW	0FFFFH°±²³°		DEFW	0FF00H°±²´°		DEFW	000FFH°±²µ°		DEFW	0FFFFH°±²¶°		DEFW	0FF00H°±²·°		DEFW	000FFH°±²¸°		DEFW	0FF00H°±²¹°		DEFW	0FFFFH°±³°°		DEFW	00000H°±³±°	DPACMN	DEFW	0FF00H°±³²°		DEFW	0FFFFH°±³³°		DEFW	00000H°±³´°		DEFW	0FFFFH°±³µ°		DEFW	0FF00H°±³¶°		DEFW	000FFH°±³·°		DEFW	0FFFFH°±³¸°		DEFW	0FF00H°±³¹°		DEFW	000FFH°±´°°	SCRACH	DEFS	30°±´±°	°±´²°	*LIST OFF°±´³°	MD	DEFM	'                                '°±´´°		DEFM	'                                '°±´µ°		DEFB	95°±´¶°		DEFM	'OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO'°±´·°		DEFM	'OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOU'°±´¸°		DEFM	'U ..............................'°±´¹°		DEFM	'.............................. U'°±µ°°		DEFM	'U . LLLLLLLLLLLLLLLD . LLLLLLLL'°±µ±°		DEFB	92°±µ²°		DEFM	'LLLLLLLD . LLLLLLLLLLLLLLLLD . U'°±µ³°		DEFM	'U ............................ E'°±µ´°		DEFM	' ............................. U'°±µµ°		DEFM	'U . LLLLLLLLLLLLLLLD . T .......'°±µ¶°		DEFM	'...... '°±µ·°		DEFB	92°±µ¸°		DEFM	'LLLLLLLLLLLLLLLLLLLT . U'°±µ¹°		DEFM	'U .................... U . '°±¶°°		DEFB	92°±¶±°		DEFM	'HHHHHHHT . U ................. U . U'°±¶²°		DEFM	'E . LLLLLLLLLLLLLLLD . E . U       U'°±¶³°		DEFM	' . E . LLLLLLLLLLLLT . MLLLE'°±¶´°		DEFM	'  ........................ U       U'°±¶µ°		DEFM	' ................. U .....  '°±¶¶°		DEFM	'T . LLLLLLLLLLLLLLLD . T . U       U'°±¶·°		DEFM	' . T . '°±¶¸°		DEFB	92°±¶¹°		DEFM	'LLLLLLLT . MLLLLLLLT'°±·°°		DEFM	'U .................... U . MLLLLLLLE'°±·±°		DEFM	' . U . U'°±·²°		DEFB	93°±·³°		DEFB	5BH°±·´°		DEFM	'THwQ U ......... U'°±·µ°		DEFM	'U . LLLD . T . LLLLD . U .............'°±·¶°		DEFM	' U . U       MLLLLLLLT . U'°±··°		DEFM	'U ........ U ......... U . T . T . T .'°±·¸°		DEFM	' U . U'°±·¹°		DEFB	95°±¸°°		DEFM	'EZKPwQWVUZKPWUU . U'°±¸±°		DEFM	'U . LLLLLLLMLLLLLLLD . E . E . U . E .'°±¸²°		DEFM	' E . MLLLLLLLLLLLLLLLE . U'°±¸³°		DEFM	'U ............................ U'°±¸´°		DEFM	' ............................. U'°±¸µ°		DEFB	125°±¸¶°		DEFM	'##############################'°±¸·°		DEFB	125°±¸¸°		DEFM	'###############################U'°±¸¹°	*LIST ON°±¹°°		DEFB	03H	;End of Maze Data°±¹±°	READY	DEFM	'Ready!'°±¹²°	MUNCH	LD	BC,4217H	;Get Seconds°±¹³°		LD	HL,0°±¹´°		LD	DE,0°±¹µ°	GETSED	LD	A,(BC)°±¹¶°		LD	L,A°±¹·°		INC	BC°±¹¸°		LD	A,(BC)°±¹¹°		LD	H,A°²°°°		ADD	HL,DE°²°±°		EX	DE,HL°²°²°		INC	BC°²°³°		INC	BC°²°´°		LD	A,1CH°²°µ°		CP	B°²°¶°		JP	P,GETSED°²°·°		LD	(RNDNUM),DE°²°¸°		LD	HL,0°²°¹°		LD	(SCORE),HL°²±°°		LD	(SCORE+2),HL°²±±°		LD	(TURNOV),HL°²±²°		LD	(DOTEAT),HL°²±³°		LD	(ENGEAT),HL°²±´°		LD	HL,-1°²±µ°		LD	(FRUIT),HL°²±¶°		LD	HL,100°²±·°		LD	(FRUIT+2),HL°²±¸°		LD	HL,3°²±¹°		LD	(MENHAV),HL°²²°°	;°²²±°		LD	A,16°²²²°		OUT	(0ECH),A	;Enable Bus (Joystick)°²²³°	;°²²´°		JP	SCREEN°²²µ°	TURN	LD	HL,(TURNOV)°²²¶°		INC	HL°²²·°		LD	(TURNOV),HL°²²¸°		LD	HL,0°²²¹°		LD	(ENGEAT),HL°²³°°		LD	(DOTEAT),HL°²³±°		LD	HL,-1°²³²°		LD	(FRUIT),HL°²³³°		CALL	RANGEN°²³´°		LD	A,(RNDNUM)°²³µ°		AND	7°²³¶°		LD	(FRUIT+4),A°²³·°		LD	A,(FRUIT+2)°²³¸°		SLA	A°²³¹°		LD	(FRUIT+2),A°²´°°		LD	A,(FRUIT+3)°²´±°		RLA°²´²°		LD	(FRUIT+3),A°²´³°		LD	HL,(FRUIT+2)°²´´°		LD	DE,3200°²´µ°		XOR	A°²´¶°		SBC	HL,DE°²´·°		JP	M,SCREEN°²´¸°		LD	HL,3200°²´¹°		LD	(FRUIT+2),HL°²µ°°	°²µ±°	SCREEN	LD	HL,MD°²µ²°		LD	DE,MAZE°²µ³°	BLDMAZ	LD	A,(HL)°²µ´°		CP	32°²µµ°		JR	Z,CHRPUT°²µ¶°		CP	46°²µ·°		JR	NZ,BOTWAL°²µ¸°		LD	BC,(DOTS)°²µ¹°		INC	BC°²¶°°		LD	(DOTS),BC°²¶±°		JR	CHRPUT°²¶²°	BOTWAL	CP	35°²¶³°		JR	NZ,DECODE°²¶´°		LD	A,124°²¶µ°	DECODE	CP	03H°²¶¶°		JR	Z,ASSMEN°²¶·°		SET	7,A°²¶¸°		XOR	64°²¶¹°	CHRPUT	LD	(DE),A°²·°°		INC	DE°²·±°		INC	HL°²·²°		JP	BLDMAZ°²·³°	ASSMEN	LD	HL,ORMNPS°²·´°		LD	DE,MENPOS°²·µ°		LD	BC,10°²·¶°		LDIR°²··°		LD	HL,MEN+2°²·¸°		LD	B,4°²·¹°	ASMEN1	SET	1,(HL)°²¸°°		INC	HL°²¸±°		DJNZ	ASMEN1°²¸²°	WRITIT	CALL	VIDCLS°²¸³°	;°²¸´°		LD	A,16+32		;Enable I/O bus °²¸µ°		OUT	(236),A°²¸¶°	;°²¸·°		LD	HL,MAZE°²¸¸°		LD	DE,3C00H°²¸¹°	FOR1	LD	A,(HL)°²¹°°		CP	46°²¹±°		JR	NZ,OUTCHR°²¹²°		LD	A,132°²¹³°	OUTCHR	LD	(DE),A°²¹´°		INC	HL°²¹µ°		INC	DE°²¹¶°		PUSH	DE°²¹·°		PUSH	HL°²¹¸°		LD	HL,3C00H+400H°²¹¹°		XOR	A°³°°°		SBC	HL,DE°³°±°		POP	HL°³°²°		POP	DE°³°³°		JR	NZ,FOR1°³°´°		LD	HL,READY°³°µ°		LD	DE,3C00H+30°³°¶°		LD	BC,6°³°·°		LDIR°³°¸°	°³°¹°	OUTMON	LD	B,4°³±°°		LD	HL,MENPOS+9°³±±°	FOR3	LD	D,(HL)°³±²°		DEC	HL°³±³°		LD	E,(HL)°³±´°		DEC	HL°³±µ°		LD	IX,MONSTR°³±¶°		;***	FIG IF SHOULD BE BLUE	***°³±·°		CALL	DISMAN°³±¸°		DJNZ	FOR3°³±¹°	°³²°°	PUTMAN	LD	HL,MENPOS°³²±°		LD	E,(HL)°³²²°		INC	HL°³²³°		LD	D,(HL)°³²´°		LD	IX,SPACMN°³²µ°		CALL	DISMAN°³²¶°	°³²·°	STAT	CALL	STATD°³²¸°		JP	GETCOM°³²¹°	STATD	LD	HL,3C00H°³³°°		LD	(4020H),HL°³³±°		LD	HL,SCORED°³³²°		CALL	VDLINE°³³³°		LD	HL,(SCORE)°³³´°		LD	(SCRACH),HL°³³µ°		CALL	DISVAL°³³¶°		LD	HL,(SCORE+2)°³³·°		LD	DE,999°³³¸°		XOR	A°³³¹°		SBC	HL,DE°³´°°		JP	P,DIS2DS°³´±°		LD	HL,(SCORE+2)°³´²°		LD	DE,99°³´³°		XOR	A°³´´°		SBC	HL,DE°³´µ°		JP	M,DIS20°³´¶°		JR	Z,DIS20°³´·°		LD	B,1°³´¸°		JR	DISZER°³´¹°	DIS20	LD	HL,(SCORE+2)°³µ°°		LD	DE,9°³µ±°		XOR	A°³µ²°		SBC	HL,DE°³µ³°		JP	M,DIS30°³µ´°		JR	Z,DIS30°³µµ°		LD	B,2°³µ¶°		JR	DISZER°³µ·°	DIS30	LD	B,3°³µ¸°	DISZER	LD	HL,ZEROES°³µ¹°		CALL	VDLINE°³¶°°		DJNZ	DISZER°³¶±°	DIS2DS	LD	HL,(SCORE+2)°³¶²°		LD	(SCRACH),HL°³¶³°		CALL	DISVAL°³¶´°		LD	HL,3C2AH°³¶µ°		LD	(4020H),HL°³¶¶°		LD	HL,TURND°³¶·°		CALL	VDLINE°³¶¸°		LD	HL,(TURNOV)°³¶¹°		LD	(SCRACH),HL°³·°°		CALL	DISVAL°³·±°		LD	HL,3C39H°³·²°		LD	(4020H),HL°³·³°		LD	HL,MENLFT°³·´°		CALL	VDLINE°³·µ°		LD	HL,(MENHAV)°³·¶°		LD	(SCRACH),HL°³··°		CALL	DISVAL°³·¸°		RET°³·¹°	°³¸²°	GETCOM	LD	A,(3840H)°³¸³°	;°³¸´°		LD	B,A°³¸µ°		IN	A,(00H)		;Get joystick°³¸¶°		CPL			;Complement it°³¸·°		SLA	A°³¸¸°		SLA	A		;align joystick°³¸¹°		SLA	A		;to go with keyboard°³¹°°		OR	B		;Combine them°³¹±°	;°³¹²°		BIT	1,A°³¹³°		JP	NZ,MUNCH°³¹´°		BIT	2,A°³¹µ°		JP	Z,$+4		;If not skip nxt instr°³¹¶°		RST	30H		;Will work with tape/disk°³¹·°		RES	7,E°³¹¸°	°³¹¹°	UCOM	BIT	3,A°´°°°		JR	Z,DCOM°´°±°		LD	HL,MENPOS°´°²°		LD	E,(HL)°´°³°		INC	HL°´°´°		LD	D,(HL)°´°µ°		DEC	D	; Go up ONE°´°¶°		CALL	SCALDD°´°·°		LD	B,6°´°¸°	ULOP1	CALL	TSTWAL°´°¹°		JR	Z,DCOM°´±°°		INC	E°´±±°		DJNZ	ULOP1°´±²°		LD	HL,MENPOS°´±³°		LD	E,(HL)°´±´°		INC	HL°´±µ°		LD	D,(HL)°´±¶°		CALL	PUERAS°´±·°		DEC	D°´±¸°		CALL	SCALDD°´±¹°		DEC	HL°´²°°		LD	(HL),E°´²±°		INC	HL°´²²°		LD	(HL),D°´²³°		LD	IX,UPACMN°´²´°		CALL	DISMAN°´²µ°	°´²¶°	DCOM	BIT	4,A°´²·°		JR	Z,LCOM°´²¸°		LD	HL,MENPOS°´²¹°		LD	E,(HL)°´³°°		INC	HL°´³±°		LD	D,(HL)°´³²°		INC	D	; Go down ONE°´³³°		INC	D°´³´°		INC	D°´³µ°		CALL	SCALDI°´³¶°		LD	B,6°´³·°	DLOP1	CALL	TSTWAL°´³¸°		JR	Z,LCOM°´³¹°		INC	E°´´°°		DJNZ	DLOP1°´´±°		LD	HL,MENPOS°´´²°		LD	E,(HL)°´´³°		INC	HL°´´´°		LD	D,(HL)°´´µ°		CALL	PDERAS°´´¶°		INC	D°´´·°		CALL	SCALDI°´´¸°		DEC	HL°´´¹°		LD	(HL),E°´µ°°		INC	HL°´µ±°		LD	(HL),D°´µ²°		LD	IX,DPACMN°´µ³°		CALL	DISMAN°´µ´°	°´µµ°	LCOM	BIT	5,A°´µ¶°		JR	Z,RCOM°´µ·°		LD	HL,MENPOS°´µ¸°		LD	E,(HL)°´µ¹°		INC	HL°´¶°°		LD	D,(HL)°´¶±°		DEC	E	; Go left ONE°´¶²°		LD	B,3°´¶³°	LLOP1	CALL	TSTWAL°´¶´°		JR	Z,RCOM°´¶µ°		INC	D°´¶¶°		CALL	SCALDI°´¶·°		DJNZ	LLOP1°´¶¸°		LD	HL,MENPOS°´¶¹°		LD	E,(HL)°´·°°		INC	HL°´·±°		LD	D,(HL)°´·²°		CALL	PLERAS°´·³°		DEC	E°´·´°		DEC	HL°´·µ°		LD	(HL),E°´·¶°		INC	HL°´··°		LD	(HL),D°´·¸°		LD	IX,LPACMN°´·¹°		CALL	DISMAN°´¸°°	°´¸±°	RCOM	BIT	6,A°´¸²°		JP	Z,GETCOM°´¸³°		LD	HL,MENPOS°´¸´°		LD	E,(HL)°´¸µ°		INC	HL°´¸¶°		LD	D,(HL)°´¸·°		LD	A,E°´¸¸°		ADD	A,6°´¸¹°		LD	E,A°´¹°°		LD	B,3°´¹±°	RLOP1	CALL	TSTWAL°´¹²°		JP	Z,GETCOM°´¹³°		INC	D°´¹´°		CALL	SCALDI°´¹µ°		DJNZ	RLOP1°´¹¶°		LD	HL,MENPOS°´¹·°		LD	E,(HL)°´¹¸°		INC	HL°´¹¹°		LD	D,(HL)°µ°°°		CALL	PRERAS°µ°±°		INC	E°µ°²°		DEC	HL°µ°³°		LD	(HL),E°µ°´°		INC	HL°µ°µ°		LD	(HL),D°µ°¶°		LD	IX,RPACMN°µ°·°		CALL	DISMAN°µ°¸°		JP	GETCOM°µ°¹°	°µ±°°	SCALDI	EX	AF,AF'°µ±±°		LD	A,D°µ±²°		CP	48°µ±³°		JP	M,RETSCL°µ±´°		LD	D,3°µ±µ°	RETSCL	EX	AF,AF'°µ±¶°		RET°µ±·°	°µ±¸°	SCALDD	EX	AF,AF'°µ±¹°		LD	A,D°µ²°°		CP	3°µ²±°		JP	P,RETSCD°µ²²°		LD	D,47°µ²³°	RETSCD	EX	AF,AF'°µ²´°		RET°µ²µ°	°µ²¶°	ENDPLY	CALL	0049H°µ²·°		JP	4909H°µ²¸°	;******		S U B R O U T I N E S   	******°µ²¹°	RANGEN	PUSH	AF°µ³°°		PUSH	BC°µ³±°		PUSH	HL°µ³²°		LD	HL,(RNDNUM)°µ³³°		ADD	HL,HL		;EASY 16 B ASL°µ³´°		LD	(RNDNUM),HL°µ³µ°		JP	C,RETRAN°µ³¶°		LD	A,(RNDNUM+1)°µ³·°		LD	B,87H°µ³¸°		XOR	B°µ³¹°		LD	(RNDNUM+1),A°µ´°°		LD	A,(RNDNUM)°µ´±°		LD	B,0DH°µ´²°		XOR	B°µ´³°		LD	(RNDNUM),A°µ´´°	RETRAN	POP	HL°µ´µ°		POP	BC°µ´¶°		POP	AF°µ´·°		RET°µ´¸°	°µ´¹°	;	PIXEL SET RESET TEST SUBROUTINE°µµ°°	;	ENTRY : (DE)=X,Y COORDS°µµ±°	;	EXIT	A-L DESTROYED°µµ²°	;	Z FLAG SET IF TEST  IS TRUE°µµ³°	SET	LD	A,0C6H°µµ´°		JR	TEST°µµµ°	RESET	LD	A,86H°µµ¶°		JR	TEST°µµ·°	PIXEL	LD	A,46H°µµ¸°	TEST	RES	7,E°µµ¹°		LD	(INST+1),A°µ¶°°		LD	A,D		;GET Y°µ¶±°		LD	B,0FFH°µ¶²°	FOR	INC	B°µ¶³°		SUB	3°µ¶´°		JP	P,FOR°µ¶µ°		ADD	A,3°µ¶¶°		SLA	A°µ¶·°		LD	C,A°µ¶¸°		LD	L,B°µ¶¹°		LD	H,0°µ·°°		LD	B,6°µ·±°	FOR2	ADD	HL,HL°µ·²°		DJNZ	FOR2°µ·³°		LD	D,0°µ·´°		SRL	E°µ·µ°		JR	NC,RESUME°µ·¶°		INC	C°µ··°	RESUME	ADD	HL,DE°µ·¸°		LD	DE,3C00H°µ·¹°		ADD	HL,DE°µ¸°°		SLA	C°µ¸±°		SLA	C°µ¸²°		SLA	C°µ¸³°		LD	A,(INST+1)°µ¸´°		ADD	A,C°µ¸µ°		LD	(INST+1),A°µ¸¶°	INST	DEFB	0CBH°µ¸·°		DEFB	0°µ¸¸°		SET	7,(HL)°µ¸¹°		RET			;BACK TO PAC ATTACK°µ¹°°	DISMAN	PUSH	DE°µ¹±°		EXX°µ¹²°		POP	DE°µ¹³°		PUSH	DE°µ¹´°		LD	B,18°µ¹µ°	DISLOP	LD	A,(IX)°µ¹¶°		CP	0FFH°µ¹·°		PUSH	DE°µ¹¸°		PUSH	BC°µ¹¹°		PUSH	AF°¶°°°		CALL	Z,SET°¶°±°		POP	AF°¶°²°		CALL	NZ,RESET°¶°³°		POP	BC°¶°´°		POP	DE°¶°µ°		INC	IX°¶°¶°		INC	E°¶°·°		LD	A,E°¶°¸°		POP	HL°¶°¹°		LD	C,L°¶±°°		PUSH	HL°¶±±°		SUB	C°¶±²°		CP	6°¶±³°		JR	NZ,FINLOP°¶±´°		LD	E,C°¶±µ°		INC	D°¶±¶°		CALL	SCALDI°¶±·°	FINLOP	DJNZ	DISLOP°¶±¸°		POP	DE°¶±¹°		EXX°¶²°°		RET°¶²±°	°¶²²°	;	ON ENTRY DE CONTAINS PREVIOUS MONSTER COORDINATES°¶²³°	°¶²´°	;	PACMAN ERASE DE CONTAINS PREVIOUS POSITION°¶²µ°	PERASE	LD	A,(PDIREC)°¶²¶°		CP	1°¶²·°		JR	Z,PRERAS°¶²¸°		CP	2°¶²¹°		JR	Z,PLERAS°¶³°°		CP	3°¶³±°		JR	Z,PUERAS°¶³²°	PDERAS	CALL	REGSAV°¶³³°		LD	B,6°¶³´°	LOOOOP	PUSH	BC°¶³µ°		PUSH	DE°¶³¶°		CALL	RESET°¶³·°		POP	DE°¶³¸°		INC	E°¶³¹°		POP	BC°¶´°°		DJNZ	LOOOOP°¶´±°		CALL	REGRST°¶´²°		RET°¶´³°	PUERAS	CALL	REGSAV°¶´´°		INC	D°¶´µ°		INC	D°¶´¶°		CALL	SCALDI°¶´·°		LD	B,6°¶´¸°	LOOOP1	PUSH	BC°¶´¹°		PUSH	DE°¶µ°°		CALL	RESET°¶µ±°		POP	DE°¶µ²°		INC	E°¶µ³°		POP	BC°¶µ´°		DJNZ	LOOOP1°¶µµ°		CALL	REGRST°¶µ¶°		RET°¶µ·°	PLERAS	CALL	REGSAV°¶µ¸°		LD	A,E°¶µ¹°		ADD	A,5°¶¶°°		LD	E,A°¶¶±°		LD	B,3°¶¶²°	LOOOP2	PUSH	BC°¶¶³°		PUSH	DE°¶¶´°		CALL	RESET°¶¶µ°		POP	DE°¶¶¶°		POP	BC°¶¶·°		INC	D°¶¶¸°		CALL	SCALDI°¶¶¹°		DJNZ	LOOOP2°¶·°°		CALL	REGRST°¶·±°		RET°¶·²°	PRERAS	CALL	REGSAV°¶·³°		LD	B,3°¶·´°	LOOOP3	PUSH	BC°¶·µ°		PUSH	DE°¶·¶°		CALL	RESET°¶··°		POP	DE°¶·¸°		POP	BC°¶·¹°		INC	D°¶¸°°		CALL	SCALDI°¶¸±°		DJNZ	LOOOP3°¶¸²°		CALL	REGRST°¶¸³°		RET°¶¸´°	WACKA	LD	HL,SWACKA°¶¸µ°		CALL	SOUND°¶¸¶°		RET°¶¸·°	SOUND	LD	C,(HL)°¶¸¸°		LD	A,C°¶¸¹°		OR	A		;ZERO?°¶¹°°	SOUND1	RET	Z°¶¹±°		INC	HL°¶¹²°	SOUND2	LD	B,(HL)°¶¹³°		LD	A,1°¶¹´°		OUT	(0FFH),A°¶¹µ°	SOUND3	DJNZ	SOUND3°¶¹¶°		LD	B,(HL)°¶¹·°		LD	A,2°¶¹¸°		OUT	(0FFH),A°¶¹¹°	SOUND4	DJNZ	SOUND4°·°°°		DEC	C°·°±°		JR	NZ,SOUND2°·°²°		INC	HL°·°³°		JR	SOUND°·°´°	°·°µ°	DIV16	LD	HL,0°·°¶°		LD	B,16°·°·°	LOOP16	RL	C°·°¸°		RLA°·°¹°		ADC	HL,HL°·±°°		SBC	HL,DE°·±±°		JR	NC,$+3°·±²°		ADD	HL,DE°·±³°		CCF°·±´°		DJNZ	LOOP16°·±µ°		RL	C°·±¶°		RLA°·±·°		RET°·±¸°	°·±¹°	; Decimal Display Routine°·²°°	; Input: Value in (SCRACH) and cursor pos. same as VDLINE°·²±°	; Output: (SCRACH) Printed to screen, nothing altered°·²²°	DISVAL	PUSH	AF°·²³°		PUSH	BC°·²´°		PUSH	DE°·²µ°		PUSH	HL		;Save Regs°·²¶°		LD	A,1°·²·°		OUT	(0FFH),A°·²¸°		LD	A,2°·²¹°		OUT	(0FFH),A°·³°°		LD	A,1°·³±°		OUT	(0FFH),A°·³²°		LD	A,2°·³³°		OUT	(0FFH),A°·³´°		LD	HL,(SCRACH)°·³µ°		LD	A,H°·³¶°		LD	C,L°·³·°		LD	DE,10°·³¸°		LD	IX,DISPLY+6°·³¹°	DISBRH	DEC	IX°·´°°		CALL	DIV16°·´±°		LD	B,A°·´²°		EX	AF,AF'		;Save Af°·´³°		LD	A,48°·´´°		ADD	A,L°·´µ°		LD	(IX),A°·´¶°		EX	AF,AF'		;Get Af back°·´·°		OR	C°·´¸°		LD	A,B		;Get A back°·´¹°		JR	NZ,DISBRH°·µ°°		PUSH	IX°·µ±°		POP	HL°·µ²°		CALL	VDLINE°·µ³°		POP	HL°·µ´°		POP	DE°·µµ°		POP	BC°·µ¶°		POP	AF°·µ·°		RET°·µ¸°	°·µ¹°	TSTWAL	CALL	REGSAV°·¶°°		CALL	WHTCHR°·¶±°		BIT	7,A°·¶²°		JR	NZ,WALL°·¶³°		CP	'.'°·¶´°		JR	Z,DOT°·¶µ°	TSTENG	CP	194°·¶¶°		JR	Z,ENGIZE°·¶·°		JR	RTTSWL	; ReTurn from TesT WaLl°·¶¸°	DOT	LD	(HL),32°·¶¹°		LD	HL,3C00H°··°°		ADD	HL,DE°··±°		RES	3,(HL)°··²°		LD	HL,10°··³°		CALL	ADTSCR°··´°	;	CALL	WACKA°··µ°		JR	RTTSWL°··¶°	ENGIZE	LD	(HL),32°···°		LD	HL,3C00H°··¸°		JP	RTTSWL°··¹°	RTTSWL	CALL	REGRST°·¸°°		PUSH	BC°·¸±°		LD	B,A°·¸²°		INC	B°·¸³°		CP	B°·¸´°		POP	BC°·¸µ°		RET°·¸¶°	WALL	BIT	6,A°·¸·°		JP	NZ,TSTENG°·¸¸°		CALL	REGRST°·¸¹°		CP	A°·¹°°		RET°·¹±°	°·¹²°	WHTCHR	SRL	E°·¹³°		PUSH	DE°·¹´°		LD	A,0°·¹µ°		LD	C,D°·¹¶°		LD	DE,3°·¹·°		CALL	DIV16°·¹¸°		LD	D,C°·¹¹°		POP	HL°¸°°°		LD	E,L°¸°±°		RL	E°¸°²°		RL	E°¸°³°		SRL	D°¸°´°		RR	E°¸°µ°		SRL	D°¸°¶°		RR	E°¸°·°		LD	HL,MAZE°¸°¸°		ADD	HL,DE°¸°¹°		LD	A,(HL)°¸±°°		RET°¸±±°	°¸±²°	REGSAV	EX	(SP),HL°¸±³°		LD	(SAVRET),HL°¸±´°		POP	HL°¸±µ°		PUSH	AF°¸±¶°		PUSH	BC°¸±·°		PUSH	DE°¸±¸°		PUSH	HL°¸±¹°		PUSH	IX°¸²°°		PUSH	IY°¸²±°		EXX°¸²²°		LD	HL,(SAVRET)°¸²³°		PUSH	HL°¸²´°		EXX°¸²µ°		RET°¸²¶°	°¸²·°	REGRST	POP	HL°¸²¸°		LD	(SAVRET),HL°¸²¹°		POP	IY°¸³°°		POP	IX°¸³±°		POP	HL°¸³²°		POP	DE°¸³³°		POP	BC°¸³´°		POP	AF°¸³µ°		EXX°¸³¶°		LD	HL,(SAVRET)°¸³·°		PUSH	HL°¸³¸°		EXX°¸³¹°		RET°¸´°°	°¸´±°	ADTSCR	CALL	REGSAV°¸´²°		LD	DE,(SCORE+2)°¸´³°		ADD	HL,DE°¸´´°		LD	(SCORE+2),HL°¸´µ°		LD	DE,10000°¸´¶°		XOR	A°¸´·°		SBC	HL,DE°¸´¸°		JP	M,RETADT°¸´¹°		LD	(SCORE+2),HL°¸µ°°		LD	HL,SCORE°¸µ±°		INC	(HL)°¸µ²°		LD	HL,MENHAV°¸µ³°		INC	(HL)°¸µ´°	RETADT	CALL	STATD°¸µµ°		CALL	REGRST°¸µ¶°		RET°¸µ·°	°¸µ¸°		END	MUNCH	;E.O.P.